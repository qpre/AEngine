var AE={MVC:{},States:{},Workers:{}};((function(){var a,b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};AE.Singleton=function(){function a(){}return a._instance=null,a.getInstance=function(){return this._instance||(this._instance=new this)},a}(),AE.Event=function(){function a(a){this._sender=a,this._subscribers=[]}return a.prototype._subscribers=null,a.prototype._sender=null,a.prototype.subscribe=function(a){return this._subscribers.push(a)},a.prototype.notify=function(a){var b,c,d,e;e=[];for(b=c=0,d=this._subscribers.length-1;c<=d;b=c+=1)e.push(this._subscribers[b](this._sender,a));return e},a}(),Function.prototype.property=function(a,b){return Object.defineProperty(this.prototype,a,b)},AE.IdFactory=function(a){function b(){this._guids=[]}return c(b,a),b.prototype._guids=null,b.prototype.has=function(a){return this._guids.indexOf(a.toString())>-1?!0:!1},b.prototype.getGUID=function(){var a;return a=this.guid(),this.has(a)?a=this.getGUID():this._guids.push(a),a},b.prototype.s4=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)},b.prototype.guid=function(){return this.s4()+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+this.s4()+this.s4()},b}(AE.Singleton),AE.Object=function(){function a(){}return a.prototype._guid=null,a.property("guid",{get:function(){return this._guid||AE.IdFactory.getInstance().getGUID(),this._guid}}),a.prototype.init=function(){},a.create=function(){var a,b;return a=this,b=new a,arguments.length>0?b.init(arguments):b.init(),b},a}(),a=Object.freeze({ACTIVE:0,PAUSED:1}),AE.States.GamePhase=function(b){function d(a,b,c,d){this._name=a,this._in=b,this._out=c,this._run=d,this._statusChangedEvent=new AE.Event(this),this._statusChangedEvent.subscribe(this.onStatusChanged)}return c(d,b),d.prototype._status=a.PAUSED,d.prototype._statusChangedEvent=null,d.prototype.notifyStatusChanged=function(){return this._statusChangedEvent.notify({status:this._status})},d.prototype.onStatusChanged=function(a,b){return console.log("status changed to :"+b.status)},d.prototype.setActive=function(){return this._status=a.ACTIVE,this.notifyStatusChanged()},d.prototype.setUnactive=function(){return this._status=a.PAUSED,this.notifyStatusChanged()},d.prototype["in"]=function(){return this._in()},d.prototype.out=function(){return this._out()},d.prototype.run=function(){return this._run()},d}(AE.Object),AE.States.GamePhasesManager=function(a){function b(){this._phases={}}return c(b,a),b.prototype._phases=null,b.prototype._current=null,b.prototype.has=function(a){return this._phases.hasOwnProperty(a)?!0:!1},b.prototype.addPhase=function(a,b,c,d){return this.has(a)?console.error("Phase "+a+" already exists"):this._phases[a]=new AE.States.GamePhase(a,b,c,d)},b.prototype.current=function(){return this._current},b.prototype.setCurrent=function(a){return this.has(a.toString())?(this._current=this._phases[a.toString()],this._current.setActive(),this._current["in"](),this._current.run()):console.error("No such phase: "+a)},b.prototype.transitionTo=function(a){return this._current===null?console.error("No current phase was set, can't transit from nowhere"):(this._current.out(),this._current.setUnactive(),this.setCurrent(a))},b}(AE.Singleton),AE.Engine=function(a){function b(){console.log("instantiating new engine")}return c(b,a),b.prototype._phasesManager=null,b.prototype._messageBox=null,b.property("PhasesManager",{get:function(){return this._phasesManager||(this._phasesManager=new AE.States.GamePhasesManager),this._phasesManager}}),b}(AE.Object),AE.MVC.Controller=function(){function a(){}return a.prototype.init=function(){},a}(),AE.MVC.Model=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return c(b,a),b.prototype._propertyChangedEvent=null,b.prototype.init=function(){return this._propertyChangedEvent=new AE.Event(this)},b.prototype.get=function(a){return this[a]},b.prototype.set=function(a,b){return this[a]=b,this.notifyPropertyChanged(a)},b.prototype.notifyPropertyChanged=function(a){return this._propertyChangedEvent.notify({property:a})},b}(AE.Object),AE.MVC.View=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return c(b,a),b.prototype.init=function(){},b}(AE.Object)})).call(this)